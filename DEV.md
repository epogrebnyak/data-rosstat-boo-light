File listing
============
```dir /B /OG```

No change:
- remote.py
- common.py
- run.py

Work on:
- sample0.py
- sample1.py
- sample2.py
- slicer.py
- make_subset.py
- reader.py

Minor change/later:
- row_parser.py
- inspect_columns.py
- config.py
- line.py

Groups of repos
===============
- parser
- presentations
- user datasets
- excercises
- album

Goals 
=====

1\. Analysis-ready datasets with no surprises/outliers:
 - csv/parsed_*.csv
 - subset/base/base_*.csv
 - subset/not_in_base/not_in_base_*.csv
 - subset/bln/bln_*.csv - companies above 1 bln rub in sales
 - subset/main/main_*.csv  - excludes 'micro' enterprises (sales < 120 mln rub in 2015), but includes companies 
   with assets above 30(?) mln
 - subset/holding
 - subset/bankrupt
 - subset/investment_spv
 - subset/sme
 
2\. Checks for final dataset consistency (balance, no outliers by name)

3\. Utility to create datasets - <run0.py>, <sample1.py>, <sample2.py>, <slicer.py>  

4\. Lecture graphs based on 'base' and subsets

5\. Task list


Development
===========

Current development branch
--------------------------
[dev](https://github.com/epogrebnyak/data-rosstat-boo-2013/tree/dev)

RawDataset, Dataset and Subset classes + 

Implementation details:
- parsing source csv files based on mapping/filtering of generators
- csv rows treated as dicts or OrderedDicts (slower, but safer than lists - columns are on their places)
- no intermediate are created csv files, just raw and final csv
- csv files not saved in repo, must be generated by end-user with minimal <run0.py> or <run.py>
- not a package, set of modules  
- some efforts to apply ```linter```, except in tests 
- folder structure not stable yet, will change


Not todo
-------
- error messages in is_filter
- provide R/Pandas reader funcs for the files as <dataset.r>, <dataset.py>
- requirement.txt to allow replicate code
- zip sliced CSVs on the fly, do not store main CSVs itself in <slicer.py> https://docs.python.org/3/library/zipfile.html
- better backend to provide this data to students, AWS S3 maybe (large files now saved to git repo, not nice) + AWS library
- Dataset(year).info() + add nice desc of columns + print list of variables / put list of variables on sheet (_fields)
- testing: subset for testing, year = 1000, test dataset + testing comments/rules + fixtures
- realign subsets.py

Unclear how to do 
-----------------
- use profiler to analyse program <https://pymotw.com/2/profile/>
- generate documentation
- fabric3 to automate some tasks (linter, py.test, builds)
- as package
- save everything in SQL database (sqlite/mysql) using sqlalchemy

Todo later
----------
- reports album
- excercises
- presentation 


Todo
----
- test right companies as largest
- slice bln and larger companies


Done or scrapped
----------------
- scapped: revert to int in DATACOLS and change tests
- new columns for cash_out and form balances
- in line.py: new dequote()
- expensive namedtuples: https://github.com/epogrebnyak/data-rosstat-boo-2013/tree/named_tuples
- chunks
  - review: make csv reader/writer work in chunks (--after profiler, tests--)
  - make <slicer.py> work in chunks, maybe it is faster rather than downloading all data to memory. use existing code from S3.
- use config or class Folder in config.py + assemble new Folder class + test [os.path.exists(d) d for d in Folder.paths]
- data import with inn: test subsetting CSV by list of INN keys
- data import with inn: provide good inn.txt example
- data import with inn:exclide inn.txt from git_ignore
- move notes.md
- review: https://github.com/epogrebnyak/data-rosstat-boo-2013/pull/3
- stricter typing in read_csv(...) using 'dtype'
- '--force' option to overwrite files
- saving clean csv does not have progress bar
- review: [change assert to Exception](https://github.com/epogrebnyak/data-rosstat-boo-2013/blob/csv_reader/columns.py#L800
- job sequencing using RosstatCSV().downlo–∞d().unrar().save_clean_copy() and Dataset(year).create_files()
- order of [module imports](http://stackoverflow.com/questions/22722976/import-order-coding-standard)
- provide data import examples in README.md (see above)
- separate 'rosstat' and 'data' directory + def get_path(filename, dir_type): in config.py
- make ```config.make_dirs()``` work in the background
